{"version":3,"sources":["components/editor-config.js","components/RuleEditor.js","components/EditPage.js"],"names":["options","fontFamily","fontLigatures","fontSize","wordWrap","languageDef","keywords","names","operators","symbols","regexpctl","regexpesc","tokenizer","root","cases","include","token","bracket","next","regexp","regexrange","strings","stringBody","dblStringBody","whitespace","configuration","brackets","comments","lineComment","createCompletionItems","range","monaco","label","kind","languages","CompletionItemKind","Event","documentation","insertText","insertTextRules","CompletionItemInsertTextRule","InsertAsSnippet","Variable","monacoLoader","config","availableLanguages","useStyles","makeStyles","theme","judgeBlock","marginTop","spacing","judgeBlockLabel","boxSizing","width","lineHeight","padding","color","fontWeight","border","borderRadius","userSelect","judgeBlockContent","borderTop","backdrop","zIndex","drawer","NameSelect","value","onChange","other","Select","MenuItem","OperatorSelect","isNumeric","ActionSelect","translateData","data","structure","key","current","then","else","push","name","optr","target","indexOf","parent","undefined","length","RuleEditor","React","forwardRef","props","ref","useTheme","classes","onNetworkError","alert","disabled","useState","defaultEditMode","editMode","setEditMode","confirmDialogOpen","setConfirmDialogOpen","backdropOpen","setBackdropOpen","compileError","setCompileError","compileErrorDialogOpen","setCompileErrorDialogOpen","defaultRuleData","ruleStructure","setRuleStructure","highlightBlock","setHighlightBlock","defaultRuleText","ruleText","setRuleText","structure2Rule","_structure2Rule","index","operator","_value","_then","_otherwise","replace","findIndex","otherwise","useImperativeHandle","sync","validate","test","getRuleText","isFirstRun","useRef","useEffect","failingStatus","handleConfirmDialogClose","source","cancel","handleCompileErrorDialogClose","handleValueTextChange","event","oldValue","newValue","handleActionSelectChange","actionType","action","newKey","res","i","Math","floor","random","toString","toUpperCase","randomKey","subIndexes","refIndex","pop","refData","slice","concat","handleHighlightButtonClick","element","document","querySelector","scrollIntoView","timeoutId","clearTimeout","setTimeout","InputLabel","required","shrink","style","Button","variant","onClick","map","refKey","isHighlight","className","data-key","background","startIcon","handleNameSwitchChange","handleOperatorSwitchChange","TextField","type","margin","multiline","fullWidth","helperText","inputProps","height","language","failing","newText","onInitError","error","handler","console","times","retry","setFailing","editorWillMount","getLanguages","some","id","register","setMonarchTokensProvider","setLanguageConfiguration","langConf","registerCompletionItemProvider","provideCompletionItems","model","position","word","getWordUntilPosition","startLineNumber","lineNumber","endLineNumber","startColumn","endColumn","suggestions","readOnly","monacoOptions","Dialog","open","onClose","DialogTitle","DialogContent","DialogContentText","DialogActions","mode","trim","axios","CancelToken","post","window","__pageData","apiBase","qs","stringify","input","params","a","cancelToken","status","result","warn","catch","isCancel","autoFocus","dangerouslySetInnerHTML","__html","Backdrop","CircularProgress","placeholder","display","flexDirection","alignItems","paddingTop","nameInput","breakpoints","up","wrapper","buttonSuccess","backgroundColor","green","buttonProgress","top","left","marginLeft","createData","ruid","remark","priority","EditPage","match","history","setRUID","initialState","setInitialState","setName","setRemark","setStatus","setPriority","nameError","setNameError","priorityError","setPriorityError","ruleData","setRuleData","compileMessage","setCompileMessage","isSaved","setIsSaved","saving","setSaving","adjusted","setAdjusted","dialogOpen","dialogTitle","dialogContent","dialogButton","setDialog","editorRef","get","handleDialogClose","Container","FormGroup","row","onBlur","flexGrow","FormControlLabel","control","Checkbox","checked","newStatus","filter","val","InputLabelProps","elevation","severity","disableElevation","valid","rule","code","_ruid","ruleset","rules","transformRuleset","size","Snackbar","autoHideDuration","Fade","in","unmountOnExit","transitionDelay"],"mappings":"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","file":"static/js/6.679913f4.chunk.js","sourcesContent":["export const monacoConfig = {\n    'vs/nls': {\n        availableLanguages: { '*': 'zh-cn' },\n    },\n};\n\nexport const options = {\n    fontFamily: \"'Fira Code', Consolas, 'Courier New', monospace\",\n    fontLigatures: true,\n    fontSize: 16,\n    wordWrap: \"on\",\n};\n\nexport const languageDef = {\n    keywords: [\n        'accept', 'review', 'spam', 'deny', 'skip',\n    ],\n\n    names: [\n        'uid', 'nick', 'email', 'url', 'content', 'length', 'ip', 'ua',\n    ],\n\n    operators: [\n        '==', '!=', '<', '>', '<=', '>=', '<-', '~',\n    ],\n\n    symbols: /[=><!~-]+/,\n\n    regexpctl: /[(){}[\\]$^|\\-*+?.]/,\n    regexpesc: /\\\\(?:[bBdDfnrstvwWn0\\\\/]|@regexpctl|c[A-Z]|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4})/,\n\n    // The main tokenizer for rule\n    tokenizer: {\n        root: [\n            // identifiers and keywords\n            [/[a-z_$][\\w$]*/, {\n                cases: {\n                    '@keywords': 'keyword',\n                    '@names': 'type.identifier',\n                    '@default': 'identifier',\n                }\n            }],\n\n            [/[[\\]:!;]/, 'delimiter'],\n\n            // whitespace and comments\n            { include: '@whitespace' },\n\n            // regular expression: magic\n            // [/\\/(?=([^\\\\/]|\\\\.)+\\/([imsxADSUXJu]*)(\\s*)(\\.|;|\\/|,|\\)|\\]|\\}|$))/, { token: 'regexp', bracket: '@open', next: '@regexp' }],\n            [/\\/(?=([^\\\\/]|\\\\.)*)/, { token: 'regexp', bracket: '@open', next: '@regexp' }],\n\n            // delimiters and operators\n            [/[{}()[\\]]/, '@brackets'],\n            [/[<>](?!@symbols)/, '@brackets'],\n            [/@symbols/, {\n                cases: {\n                    '@operators': 'operator',\n                    '@default': ''\n                }\n            }],\n\n            // numbers\n            [/\\d+/, 'number'],\n\n            // strings\n            { include: '@strings' },\n        ],\n\n        regexp: [\n            [/(\\{)(\\d+(?:,\\d*)?)(\\})/, ['regexp.escape.control', 'regexp.escape.control', 'regexp.escape.control']],\n            [/(\\[)(\\^?)(?=(?:[^\\]\\\\/]|\\\\.)+)/, ['regexp.escape.control', { token: 'regexp.escape.control', next: '@regexrange' }]],\n            [/(\\()(\\?:|\\?=|\\?!)/, ['regexp.escape.control', 'regexp.escape.control']],\n            [/[()]/, 'regexp.escape.control'],\n            [/@regexpctl/, 'regexp.escape.control'],\n            [/[^\\\\/]/, 'regexp'],\n            [/@regexpesc/, 'regexp.escape'],\n            [/\\\\\\./, 'regexp.invalid'],\n            [/(\\/)([imsxADSUXJu]*)/, [{ token: 'regexp', bracket: '@close', next: '@pop' }, 'keyword.other']],\n        ],\n\n        regexrange: [\n            [/-/, 'regexp.escape.control'],\n            [/\\^/, 'regexp.invalid'],\n            [/@regexpesc/, 'regexp.escape'],\n            [/[^\\]]/, 'regexp'],\n            [/\\]/, { token: 'regexp.escape.control', next: '@pop', bracket: '@close' }],\n        ],\n\n        strings: [\n            [/'/, 'string.escape', '@stringBody'],\n            [/\"/, 'string.escape', '@dblStringBody'],\n        ],\n        \n        stringBody: [\n            [/[^\\\\']+/, 'string'],\n            [/\\\\./, 'string'],\n            [/'/, 'string.escape', '@popall'],\n        ],\n        \n        dblStringBody: [\n            [/[^\\\\\"]+/, 'string'],\n            [/\\\\./, 'string'],\n            [/\"/, 'string.escape', '@popall'],\n        ],\n\n        whitespace: [\n            [/[ \\t\\r\\n]+/, 'white'],\n            [/(^#.*$)/, 'comment'],\n        ],\n    },\n};\n\nexport const configuration = {\n    brackets: [\n        [\"[\", \"]\"],\n    ],\n    comments: {\n        lineComment: \"#\",\n    },\n};\n\nexport const createCompletionItems = (range, monaco) => [\n    {\n        label: 'accept',\n        kind: monaco.languages.CompletionItemKind.Event,\n        documentation: \"标记当前评论为通过\",\n        insertText: 'accept',\n        range: range,\n    },\n    {\n        label: 'review',\n        kind: monaco.languages.CompletionItemKind.Event,\n        documentation: \"标记当前评论为待审核\",\n        insertText: 'review',\n        range: range,\n    },\n    {\n        label: 'spam',\n        kind: monaco.languages.CompletionItemKind.Event,\n        documentation: \"标记当前评论为垃圾\",\n        insertText: 'spam',\n        range: range,\n    },\n    {\n        label: 'deny',\n        kind: monaco.languages.CompletionItemKind.Event,\n        documentation: \"禁止当前评论\",\n        insertText: 'deny',\n        insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n        range: range,\n    },\n    {\n        label: 'skip',\n        kind: monaco.languages.CompletionItemKind.Event,\n        documentation: \"跳过当前评论，交由下级规则或默认配置处理\",\n        insertText: 'skip',\n        insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n        range: range,\n    },\n    {\n        label: 'uid',\n        kind: monaco.languages.CompletionItemKind.Variable,\n        documentation: \"评论用户的 <code>uid</code>，游客为 0\",\n        insertText: 'uid',\n        insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n        range: range,\n    },\n    {\n        label: 'nick',\n        kind: monaco.languages.CompletionItemKind.Variable,\n        documentation: \"评论用户的昵称\",\n        insertText: 'nick',\n        insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n        range: range,\n    },\n    {\n        label: 'email',\n        kind: monaco.languages.CompletionItemKind.Variable,\n        documentation: \"评论用户的 Email 地址\",\n        insertText: 'email',\n        insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n        range: range,\n    },\n    {\n        label: 'url',\n        kind: monaco.languages.CompletionItemKind.Variable,\n        documentation: \"评论用户的个人主页地址，可能为空\",\n        insertText: 'url',\n        insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n        range: range,\n    },\n    {\n        label: 'content',\n        kind: monaco.languages.CompletionItemKind.Variable,\n        documentation: \"评论内容\",\n        insertText: 'content',\n        insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n        range: range,\n    },\n    {\n        label: 'length',\n        kind: monaco.languages.CompletionItemKind.Variable,\n        documentation: \"评论内容长度\",\n        insertText: 'length',\n        insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n        range: range,\n    },\n    {\n        label: 'ip',\n        kind: monaco.languages.CompletionItemKind.Variable,\n        documentation: \"评论用户的 IP 地址\",\n        insertText: 'ip',\n        insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n        range: range,\n    },\n    {\n        label: 'ua',\n        kind: monaco.languages.CompletionItemKind.Variable,\n        documentation: \"评论用户的 User-Agent 值\",\n        insertText: 'ua',\n        insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n        range: range,\n    },\n];\n","import React from 'react';\nimport axios from 'axios';\nimport qs from 'qs';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Button from '@material-ui/core/Button';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport TextField from '@material-ui/core/TextField';\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\nimport ArrowUpwardIcon from '@material-ui/icons/ArrowUpward';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Backdrop from '@material-ui/core/Backdrop';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport { makeStyles, useTheme } from '@material-ui/core/styles';\nimport { monacoLoader, MonacoEditor } from '@rimoe/react-monaco-editor';\n\nimport { monacoConfig, options as monacoOptions, languageDef, configuration as langConf, createCompletionItems } from './editor-config';\n\nmonacoLoader.config(monacoConfig);\n\nconst useStyles = makeStyles((theme) => ({\n    judgeBlock: {\n        marginTop: theme.spacing(1),\n    },\n    judgeBlockLabel: {\n        boxSizing: \"border-box\",\n        width: \"100%\",\n        lineHeight: 1,\n        padding: \"9px 14px\",\n        color: \"rgba(0, 0, 0, 0.38)\",\n        fontWeight: 700,\n        fontSize: \"12px\",\n        border: \"1px solid rgba(0, 0, 0, 0.12)\",\n        borderRadius: \"3px 3px 0 0\",\n        userSelect: \"none\",\n    },\n    judgeBlockContent: {\n        border: \"1px solid rgba(0, 0, 0, 0.12)\",\n        borderTop: \"none\",\n        borderRadius: \"0 0 3px 3px\",\n        padding: \"14px\",\n        '&>div:nth-child(2)': {\n            marginTop: theme.spacing(1),\n        },\n    },\n    backdrop: {\n        zIndex: theme.zIndex.drawer + 1,\n        color: '#fff',\n    },\n}));\n\nfunction NameSelect({ value, onChange, ...other }) {\n    // ['uid', 'nick', 'email', 'url', 'content', 'length', 'ip', 'ua']\n    return (\n        <Select\n            value={value}\n            onChange={onChange}\n            {...other}\n        >\n            <MenuItem value=\"uid\">UID</MenuItem>\n            <MenuItem value=\"nick\">昵称</MenuItem>\n            <MenuItem value=\"email\">邮箱</MenuItem>\n            <MenuItem value=\"url\">个人主页</MenuItem>\n            <MenuItem value=\"content\">评论内容</MenuItem>\n            <MenuItem value=\"length\">评论有效长度</MenuItem>\n            <MenuItem value=\"ip\">IP</MenuItem>\n            <MenuItem value=\"ua\">User-Agent</MenuItem>\n        </Select>\n    );\n}\n\nfunction OperatorSelect({ value, isNumeric, onChange, ...other }) {\n    // ['==', '!=', '<', '>', '<=', '>=', '<-', '~']\n    return isNumeric ? (\n        <Select\n            value={value}\n            onChange={onChange}\n            {...other}\n        >\n            <MenuItem value=\"==\">等于</MenuItem>\n            <MenuItem value=\"!=\">不等于</MenuItem>\n            <MenuItem value=\"<\">小于</MenuItem>\n            <MenuItem value=\">\">大于</MenuItem>\n            <MenuItem value=\"<=\">小于或等于</MenuItem>\n            <MenuItem value=\">=\">大于或等于</MenuItem>\n        </Select>\n        ) : (\n        <Select\n            value={value}\n            onChange={onChange}\n            {...other}\n        >\n            <MenuItem value=\"==\">等于（全字匹配）</MenuItem>\n            <MenuItem value=\"!=\">不等于（全字匹配）</MenuItem>\n            <MenuItem value=\"<-\">包含</MenuItem>\n            <MenuItem value=\"~\">符合（正则表达式）</MenuItem>\n        </Select>\n    );\n}\n\nfunction ActionSelect({ value, onChange, ...other }) {\n    // ['accept', 'review', 'spam', 'deny', 'skip']\n    return (\n        <Select\n            value={value}\n            onChange={onChange}\n            {...other}\n        >\n            <MenuItem value=\"skip\">无动作</MenuItem>\n            <MenuItem value=\"accept\">通过评论</MenuItem>\n            <MenuItem value=\"review\">标记为待审核</MenuItem>\n            <MenuItem value=\"spam\">标记为垃圾</MenuItem>\n            <MenuItem value=\"deny\">拒绝评论</MenuItem>\n            <MenuItem value=\"judge\">继续判断</MenuItem>\n        </Select>\n    );\n}\n\nfunction randomKey() {\n    let res = \"#\";\n    for (let i = 0; i < 6; i++) res += Math.floor(Math.random() * 16).toString(16);\n    return res.toUpperCase();\n}\n\nfunction translateData(data) {\n    if (typeof data !== \"object\" || !data) return undefined;\n    const structure = [];\n    for (let key in data) {\n        const current = data[key];\n        if (!current.then) current.then = \"skip\";\n        if (!current.else) current.else = \"skip\";\n        structure.push([\n            key, current.name, current.optr, current.target,\n            (current.then.indexOf(\"#\") !== -1)\n                ? [\"judge\", current.then]\n                : [current.then],\n            (current.else.indexOf(\"#\") !== -1)\n                ? [\"judge\", current.else]\n                : [current.else],\n            current.parent ?? undefined\n        ]);\n    }\n    if (structure.length === 0) return undefined;\n    return structure;\n}\n\nconst RuleEditor = React.forwardRef((props, ref) => {\n    const theme = useTheme();\n    const classes = useStyles();\n\n    const onChange = props.onChange ?? (() => {});\n    const onNetworkError = props.onNetworkError ?? (() => { alert(\"请求后端 API 失败！\"); });\n    const disabled = props.disabled ?? false;\n    const [editMode, setEditMode] = React.useState(props.defaultEditMode ?? 0); // 0 => 所见即所得编辑模式，1 => 规则文本编辑模式\n    const [confirmDialogOpen, setConfirmDialogOpen] = React.useState(false);\n    const [backdropOpen, setBackdropOpen] = React.useState(false);\n    const [compileError, setCompileError] = React.useState(\"\");\n    const [compileErrorDialogOpen, setCompileErrorDialogOpen] = React.useState(false);\n    const [ruleStructure, setRuleStructure] = React.useState(translateData(props.defaultRuleData)\n        ?? [[\"#Main\", \"uid\", \"==\", \"\", [\"skip\"], [\"skip\"], undefined]]);\n    const [highlightBlock, setHighlightBlock] = React.useState([undefined, undefined]);\n    const [ruleText, setRuleText] = React.useState(props.defaultRuleText ?? \"\");\n\n    const structure2Rule = () => { // 使用 structure2Rule() 获得完整规则文本\n        const _structure2Rule = (index) => {\n            const [, name, operator, _value, _then, _otherwise] = ruleStructure[index];\n            const value = ([\"uid\", \"length\"].indexOf(name) === -1 && operator !== \"~\")\n                ? `'${_value.replace(/\\\\/g, '\\\\\\\\').replace(/'/g, '\\\\\\'')}'`\n                : _value;\n            const then = (_then[0] === \"judge\")\n                ? _structure2Rule(ruleStructure.findIndex(([key]) => (key === _then[1])))\n                : _then[0];\n            const otherwise = (_otherwise[0] === \"judge\")\n                ? _structure2Rule(ruleStructure.findIndex(([key]) => (key === _otherwise[1])))\n                : _otherwise[0];\n            return `[ ${name} ${operator} ${value} ] : ${then} ! ${otherwise} ;`;\n        }\n        return _structure2Rule(0);\n    };\n\n    React.useImperativeHandle(ref, () => ({\n        editMode: editMode,\n        sync: () => {\n            (props.defaultEditMode !== undefined) && setEditMode(props.defaultEditMode);\n            (props.defaultRuleData !== undefined) && setRuleStructure(translateData(props.defaultRuleData));\n            (props.defaultRuleText !== undefined) && setRuleText(props.defaultRuleText);\n        },\n        validate: () => {\n            if (editMode === 0) {\n                for (let [, name, , value] of ruleStructure) {\n                    if ([\"uid\", \"length\"].indexOf(name) !== -1) {\n                        if (!/^\\d+$/.test(value)) return false;\n                    }\n                }\n            }\n            return true;\n        },\n        getRuleText: () => (editMode === 0 ? structure2Rule() : ruleText),\n    }));\n\n    const isFirstRun = React.useRef(true);\n    React.useEffect(() => {\n        if (isFirstRun.current) {\n            isFirstRun.current = false;\n            return;\n        }\n        onChange();\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [editMode, ruleStructure, ruleText]);\n\n    const failingStatus = React.useRef(false);\n    const handleSwitchMode = () => {\n        if (failingStatus.current && editMode === 1) {\n            setEditMode(0);\n            return;\n        }\n        setConfirmDialogOpen(true);\n    };\n\n    const handleConfirmDialogClose = () => {\n        setConfirmDialogOpen(false);\n    };\n\n    const source = React.useRef();\n    React.useEffect(() => (() => {\n        if (backdropOpen) source.current.cancel();\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }), []);\n\n    const handleConfirmDialogConfirmClick = () => {\n        setConfirmDialogOpen(false);\n        setEditMode((mode) => {\n            if (mode === 0) setRuleText(structure2Rule());\n            else {\n                if (!ruleText || ruleText.trim() === \"\") return 0;\n                source.current = axios.CancelToken.source();\n                setBackdropOpen(true);\n                axios.post(window.__pageData.apiBase, qs.stringify({\n                    input: ruleText,\n                }), {\n                    params: {\n                        a: \"translate\",\n                    },\n                    cancelToken: source.current.token,\n                }).then(({ data, status }) => {\n                    if (status === 204) setEditMode(0);\n                    else if (status === 201) {\n                        setCompileError(data.result);\n                        setCompileErrorDialogOpen(true);\n                    } else if (status === 200) {\n                        setRuleStructure(translateData(data));\n                        setEditMode(0);\n                    } else console.warn(`Unknown status code: ${status}.`);\n                    setBackdropOpen(false);\n                }).catch((error) => {\n                    if (!axios.isCancel(error)) {\n                        console.error(error);\n                        onNetworkError(error);\n                    }\n                    setBackdropOpen(false);\n                });\n            }\n            return 1;\n        });\n    }\n\n    const handleCompileErrorDialogClose = () => {\n        setCompileErrorDialogOpen(false);\n    };\n\n    const handleNameSwitchChange = (index, event) => {\n        const { value } = event.target; // see https://stackoverflow.com/a/56629758\n        setRuleStructure((oldValue) => {\n            let newValue = [...oldValue];\n            newValue[index][1] = value;\n            newValue[index][2] = \"==\";\n            newValue[index][3] = \"\";\n            return newValue;\n        });\n    };\n\n    const handleOperatorSwitchChange = (index, event) => {\n        const { value } = event.target;\n        setRuleStructure((oldValue) => {\n            let newValue = [...oldValue];\n            newValue[index][2] = value;\n            return newValue;\n        });\n    };\n\n    const handleValueTextChange = (index, event) => {\n        const { value } = event.target;\n        setRuleStructure((oldValue) => {\n            let newValue = [...oldValue];\n            newValue[index][3] = value;\n            return newValue;\n        });\n    };\n\n    const handleActionSelectChange = (index, actionType, event) => {\n        const { value } = event.target;\n        setRuleStructure((oldValue) => {\n            let newValue = [...oldValue], action = [...oldValue[index][4 + actionType]];\n            if (action[0] === value) return newValue;\n            if (value === \"judge\") { // 新增一个 block\n                const newKey = randomKey();\n                action = [\"judge\", newKey];\n                newValue.push([newKey, \"uid\", \"==\", \"\", [\"skip\"], [\"skip\"], oldValue[index][0]]);\n            } else if (action[0] === \"judge\") { // 删除（可能是）一些 blocks\n                const subIndexes = [newValue.findIndex(([key]) => (key === action[1]))];\n                while (subIndexes.length > 0) {\n                    const refIndex = subIndexes.pop(), refData = [...newValue[refIndex]];\n                    if (refIndex < index) index--; // 此时当前项目的 index 将会前移\n                    newValue = newValue.slice(0, refIndex).concat(newValue.slice(refIndex + 1));\n                    if (refData[4][0] === \"judge\") subIndexes.push(newValue.findIndex(([key]) => (key === refData[4][1])));\n                    if (refData[5][0] === \"judge\") subIndexes.push(newValue.findIndex(([key]) => (key === refData[5][1])));\n                }\n                action = [value];\n            } else action = [value];\n            newValue[index][4 + actionType] = action;\n            return newValue;\n        });\n    };\n\n    const handleHighlightButtonClick = (key) => {\n        ((element) => (element && element.scrollIntoView()))(document.querySelector(`div[data-key=\"${key}\"]`));\n        setHighlightBlock(([_, timeoutId]) => {\n            if (timeoutId !== undefined) clearTimeout(timeoutId);\n            return [key, setTimeout(() => {\n                setHighlightBlock([undefined, undefined]);\n            }, 1000)];\n        });\n    };\n\n    const handleEditorChange = (newText) => {\n        setRuleText(newText);\n    };\n\n    const handleMonacoInitError = (error, handler) => {\n        console.error('Monaco initialization error:', error);\n        if (handler.times <= 3) handler.retry();\n        else {\n            failingStatus.current = true;\n            handler.setFailing(true);\n        }\n    };\n\n    const editorWillMount = (monaco) => {\n        failingStatus.current = false;\n        if (!monaco.languages.getLanguages().some(({ id }) => (id === \"rule\"))) {\n            monaco.languages.register({ id: \"rule\" });\n            monaco.languages.setMonarchTokensProvider(\"rule\", languageDef);\n            monaco.languages.setLanguageConfiguration(\"rule\", langConf);\n            monaco.languages.registerCompletionItemProvider(\"rule\", {\n                provideCompletionItems: (model, position) => {\n                    const word = model.getWordUntilPosition(position);\n                    const range = {\n                        startLineNumber: position.lineNumber,\n                        endLineNumber: position.lineNumber,\n                        startColumn: word.startColumn,\n                        endColumn: word.endColumn,\n                    };\n                    return {\n                        suggestions: createCompletionItems(range, monaco),\n                    };\n                }\n            });\n        }\n    };\n\n    return (\n        <>\n            <InputLabel required shrink disabled={disabled}>规则内容</InputLabel>\n            <div style={{ marginTop: theme.spacing(1) }} />\n            <Button\n                variant=\"outlined\"\n                color={[\"primary\", \"secondary\"][editMode]}\n                onClick={handleSwitchMode}\n                disabled={disabled}\n            >切换到{[\"规则文本\", \"所见即所得\"][editMode]}编辑模式</Button>\n            <div style={{ marginTop: theme.spacing(1) }} />\n            {editMode === 0 ? (\n                <div>{ruleStructure.map(([key, name, operator, value, then, otherwise, refKey], index) => {\n                    const isNumeric = [\"uid\", \"length\"].indexOf(name) !== -1;\n                    const isHighlight = highlightBlock[0] === key;\n                    return (\n                        <div key={key} className={classes.judgeBlock} data-key={key}>\n                            <div\n                                className={classes.judgeBlockLabel}\n                                style={isHighlight ? { background: \"#fffdd1\" } : {}}\n                            >{key}</div>\n                            <div className={classes.judgeBlockContent} style={disabled ? { color: \"rgba(0, 0, 0, 0.38)\" } : {}}>\n                                {/* 如果 {name} {operator} {value}，那么 {then}，否则 {otherwise} */}\n                                <div>\n                                    {refKey !== undefined && (<>\n                                        <Button\n                                            startIcon={<ArrowUpwardIcon />}\n                                            onClick={() => handleHighlightButtonClick(refKey)}\n                                            disabled={disabled}\n                                        >{refKey}</Button>\n                                        &emsp;\n                                    </>)}\n                                    如果&emsp;\n                                    <NameSelect\n                                        value={name}\n                                        onChange={(event) => handleNameSwitchChange(index, event)}\n                                        disabled={disabled}\n                                    />\n                                    &emsp;\n                                    <OperatorSelect\n                                        value={operator}\n                                        isNumeric={isNumeric}\n                                        onChange={(event) => handleOperatorSwitchChange(index, event)}\n                                        disabled={disabled}\n                                    />\n                                    &emsp;\n                                    {isNumeric ? (\n                                        <TextField\n                                            value={value}\n                                            onChange={(event) => handleValueTextChange(index, event)}\n                                            required\n                                            type=\"number\"\n                                            margin=\"none\"\n                                            disabled={disabled}\n                                        />\n                                    ) : (\n                                        <TextField\n                                            value={value}\n                                            onChange={(event) => handleValueTextChange(index, event)}\n                                            multiline\n                                            fullWidth\n                                            helperText=\"允许多行，书写字符串时两侧无需加引号，书写正则表达式时需要使用 / 作为分隔符\"\n                                            margin=\"none\"\n                                            inputProps={{\n                                                style: { fontFamily: \"'Fira Code', Consolas, 'Courier New', monospace\" }\n                                            }}\n                                            disabled={disabled}\n                                        />\n                                    )}\n                                </div>\n                                <div>\n                                    那么&emsp;\n                                    <ActionSelect\n                                        value={then[0]}\n                                        onChange={(event) => handleActionSelectChange(index, 0, event)}\n                                        disabled={disabled}\n                                    />\n                                    {then[0] === \"judge\" && (<>\n                                        &emsp;\n                                        <Button\n                                            startIcon={<ArrowDownwardIcon />}\n                                            onClick={() => handleHighlightButtonClick(then[1])}\n                                            disabled={disabled}\n                                        >{then[1]}</Button>\n                                    </>)}\n                                    &emsp;\n                                    否则&emsp;\n                                    <ActionSelect\n                                        value={otherwise[0]}\n                                        onChange={(event) => handleActionSelectChange(index, 1, event)}\n                                        disabled={disabled}\n                                    />\n                                    {otherwise[0] === \"judge\" && (<>\n                                        &emsp;\n                                        <Button\n                                            startIcon={<ArrowDownwardIcon />}\n                                            onClick={() => handleHighlightButtonClick(otherwise[1])}\n                                            disabled={disabled}\n                                        >{otherwise[1]}</Button>\n                                    </>)}\n                                </div>\n                            </div>\n                        </div>\n                    );\n                })}</div>\n            ) : (\n                <MonacoEditor\n                    height=\"600px\"\n                    language=\"rule\"\n                    theme=\"vs-dark\"\n                    value={ruleText}\n                    failing=\"编辑器加载失败，请刷新重试。如果规则尚未保存，请尝试切换至所见即所得编辑模式保存以避免数据丢失；如果规则已保存，请直接刷新重试，切换模式将导致数据丢失。\"\n                    onChange={handleEditorChange}\n                    onInitError={handleMonacoInitError}\n                    editorWillMount={editorWillMount}\n                    options={{ readOnly: disabled, ...monacoOptions }}\n                />\n            )}\n            <Dialog\n                open={confirmDialogOpen}\n                onClose={handleConfirmDialogClose}\n            >\n                <DialogTitle>确定要切换吗？</DialogTitle>\n                <DialogContent>\n                    <DialogContentText>\n                        由于对已有内容的转换不保证 100% 兼容，我们更建议仅使用一种模式来编辑规则。（如果您还没有开始编辑规则，请忽略此提示直接点击确定）\n                    </DialogContentText>\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={handleConfirmDialogConfirmClick} color=\"secondary\">\n                        确定\n                    </Button>\n                    <Button onClick={handleConfirmDialogClose} color=\"primary\" autoFocus>\n                        取消\n                    </Button>\n                </DialogActions>\n            </Dialog>\n            <Dialog\n                open={compileErrorDialogOpen}\n                onClose={handleCompileErrorDialogClose}\n            >\n                <DialogTitle>规则编译失败！</DialogTitle>\n                <DialogContent>\n                    <DialogContentText\n                        dangerouslySetInnerHTML={{\n                            __html: compileError + \"<br />如果需要强制切换，请将输入框清空。强制切换将会使当前编辑内容丢失。\"\n                        }}\n                    />\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={handleCompileErrorDialogClose} color=\"primary\" autoFocus>\n                        确定\n                    </Button>\n                </DialogActions>\n            </Dialog>\n            <Backdrop className={classes.backdrop} open={backdropOpen}>\n                <CircularProgress color=\"inherit\" />\n            </Backdrop>\n        </>\n    );\n});\n\nexport default RuleEditor;\n","import React from 'react';\nimport axios from 'axios';\nimport qs from 'qs';\nimport Fade from '@material-ui/core/Fade';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Container from '@material-ui/core/Container';\nimport FormGroup from '@material-ui/core/FormGroup';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport TextField from '@material-ui/core/TextField';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport Button from '@material-ui/core/Button';\nimport SaveIcon from '@material-ui/icons/Save';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport MuiAlert from '@material-ui/lab/Alert';\nimport makeStyles from '@material-ui/core/styles/makeStyles';\nimport useTheme from '@material-ui/core/styles/useTheme';\nimport { green } from '@material-ui/core/colors';\n\nimport RuleEditor from './RuleEditor';\n\nconst useStyles = makeStyles((theme) => ({\n    placeholder: {\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n        paddingTop: theme.spacing(8),\n    },\n    nameInput: {\n        width: \"calc(75% - \" + theme.spacing(2) + \"px)\",\n        [theme.breakpoints.up('md')]: {\n            width: \"50%\",\n        },\n    },\n    wrapper: {\n        position: 'relative',\n        display: 'inline-block',\n    },\n    buttonSuccess: {\n        backgroundColor: green[500],\n        '&:hover': {\n            backgroundColor: green[700],\n        },\n    },\n    buttonProgress: {\n        color: green[500],\n        position: 'absolute',\n        top: '50%',\n        left: '50%',\n        marginTop: -12,\n        marginLeft: -12,\n    },\n}));\n\nfunction createData(name, ruid, remark, status, priority) {\n    return { name, ruid, remark, status, priority };\n}\n\nfunction transformRuleset(ruleset) {\n    if (typeof ruleset !== \"object\" || !ruleset) return [];\n    const rules = [];\n    for (let ruid in ruleset) {\n        const { name, remark, status, priority } = ruleset[ruid];\n        rules.push(createData(name, ruid, remark, status, priority));\n    }\n    return rules;\n}\n\nexport default function EditPage(props) {\n    const theme = useTheme();\n    const classes = useStyles();\n    const { match, history } = props;\n    const [ruid, setRUID] = React.useState(match.params.ruid ?? false);\n    const [initialState, setInitialState] = React.useState(ruid ? false : true);\n    const [name, setName] = React.useState(\"\");\n    const [remark, setRemark] = React.useState(\"\");\n    const [status, setStatus] = React.useState([\"on\"]);\n    const [priority, setPriority] = React.useState(10);\n    const [nameError, setNameError] = React.useState(false);\n    const [priorityError, setPriorityError] = React.useState(false);\n    const [editMode, setEditMode] = React.useState(0);\n    const [ruleData, setRuleData] = React.useState(undefined);\n    const [ruleText, setRuleText] = React.useState(\"\");\n    const [compileMessage, setCompileMessage] = React.useState(\"\");\n    const [isSaved, setIsSaved] = React.useState(ruid ? true : false);\n    const [saving, setSaving] = React.useState(false);\n    const [adjusted, setAdjusted] = React.useState(false);\n    const [[dialogOpen, dialogTitle, dialogContent, dialogButton], setDialog] = React.useState([false, \"\", \"\", \"\"]);\n    const editorRef = React.useRef(); // 使用 editorRef.current.getRuleText() 来获取规则文本\n\n    const source = React.useRef();\n    React.useEffect(() => {\n        source.current = axios.CancelToken.source();\n        if (!initialState) {\n            axios.get(window.__pageData.apiBase, {\n                params: {\n                    a: \"ruleDetails\",\n                    ruid: ruid,\n                },\n                cancelToken: source.current.token,\n            }).then(({ data }) => {\n                setName(data.name);\n                setRemark(data.remark);\n                setStatus(data.status);\n                setPriority(data.priority);\n                setEditMode(data.editMode);\n                if (data.editMode === 0) setRuleData(data.ruleData);\n                else setRuleText(data.ruleText);\n                setCompileMessage(data.compileMessage);\n                if (editorRef.current !== undefined) editorRef.current.sync();\n                setInitialState(true);\n            }).catch((error) => {\n                if (!axios.isCancel(error)) {\n                    console.error(error);\n                    history.push(\"/overview\");\n                }\n            });\n        }\n        return () => {\n            if (!initialState || saving) source.current.cancel();\n        };\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n\n    const handleNameChange = (event) => {\n        const { value } = event.target;\n        setName(value);\n        setNameError(value === \"\");\n        setIsSaved(false);\n    };\n\n    const handleIsEnabledChange = (event) => {\n        const { checked } = event.target;\n        let newStatus;\n        if (checked) {\n            newStatus = [\"on\", ...status.filter((val) => (val !== \"off\" && val !== \"uncompiled\"))];\n        } else {\n            newStatus = [\"off\", ...status.filter((val) => (val !== \"on\"))];\n        }\n        setStatus(newStatus);\n        setIsSaved(false);\n    };\n\n    const handlePriorityChange = (event) => {\n        const { value } = event.target;\n        setPriority(value);\n        setPriorityError(!/^(0|[1-9][0-9]{0,4})$/.test(value));\n        setIsSaved(false);\n    };\n\n    const handleRemarkChange = (event) => {\n        const { value } = event.target;\n        setRemark(value);\n        setIsSaved(false);\n    };\n\n    const handleRuleEditorChange = () => {\n        setIsSaved(false);\n    };\n\n    const handleRuleEditorNetworkError = () => {\n        setDialog([true, \"请求后端 API 失败！\", \"可能是网络错误或后端处理失败，请打开开发人员工具查看详细信息。\", \"确定\"]);\n    };\n\n    const handleSaveButtonClick = () => {\n        if (isSaved || saving) return;\n\n        let valid = true;\n        if (name === \"\") {\n            setNameError(true);\n            valid = false;\n        }\n        if (!/^(0|[1-9][0-9]{0,4})$/.test(priority)) {\n            setPriorityError(true);\n            valid = false;\n        }\n        if (!valid) return;\n        if (!editorRef.current.validate()) {\n            setDialog([true, \"规则内容不合法！\", \"请检查数值比较的值是否合法，只有非负整数是合法的，非法的值将无法通过编译。\", \"确定\"]);\n            return;\n        }\n        const ruleText = editorRef.current.getRuleText();\n        if (ruleText.trim() === \"\") {\n            setDialog([true, \"规则内容不能为空！\", \"空规则将不起作用，请设置规则内容。\", \"确定\"]);\n            return;\n        }\n\n        source.current = axios.CancelToken.source();\n        setSaving(true);\n        axios.post(window.__pageData.apiBase, qs.stringify({\n            ruid: ruid ? ruid : \"\",\n            name: name,\n            status: status,\n            remark: remark,\n            priority: priority,\n            rule: ruleText,\n            editMode: editorRef.current.editMode,\n        }), {\n            params: {\n                a: \"saveRule\",\n            },\n            cancelToken: source.current.token,\n        }).then(({ data: { code, ruid: _ruid, ruleset }, status }) => {\n            if (status === 200) {\n                if (!ruid) {\n                    setRUID(_ruid);\n                    history.push(\"/edit/\" + _ruid);\n                }\n                window.__pageData.rules = transformRuleset(ruleset);\n                const { status, compileMessage } = ruleset[_ruid];\n                setStatus(status);\n                setCompileMessage(compileMessage);\n                setIsSaved(true);\n                if (code === 201) {\n                    setAdjusted(true);\n                }\n            } else if (status === 201) {\n                setDialog([true, \"后端 API 返回错误！\",\n                    \"保存规则时遇到了未知错误，请检查插件目录权限，必要时请移步 <a href='https://github.com/wuxianucw/Typecho-CommentRuleset/issues' target='_blank'>GitHub issues</a>。\",\n                    \"确定\"]);\n            } else console.warn(`Unknown status code: ${status}.`);\n            setSaving(false);\n        }).catch((error) => {\n            if (!axios.isCancel(error)) {\n                console.error(error);\n                setDialog([true, \"请求后端 API 失败！\", \"可能是网络错误或后端处理失败，请打开开发人员工具查看详细信息。\", \"确定\"]);\n            }\n            setSaving(false);\n        });\n    };\n\n    const handleIsCompiledChange = (event) => {\n        const { checked } = event.target;\n        let newStatus;\n        if (checked) {\n            newStatus = status.filter((val) => (val !== \"uncompiled\"));\n        } else {\n            newStatus = [\"off\", \"uncompiled\"];\n        }\n        setStatus(newStatus);\n        setIsSaved(false);\n    };\n\n    const handleDialogClose = () => {\n        setDialog(([, ...oldValue]) => {\n            return [false, ...oldValue];\n        })\n    };\n\n    return initialState ? (\n        <Container>\n            <FormGroup row>\n                <TextField\n                    value={name}\n                    onChange={handleNameChange}\n                    inputProps={{\n                        onBlur: (event) => setNameError(event.target.value === \"\"),\n                    }}\n                    required\n                    error={nameError}\n                    helperText={nameError ? \"规则名称不能为空\" : \"\"}\n                    label=\"规则名称\"\n                    variant=\"outlined\"\n                    margin=\"normal\"\n                    className={classes.nameInput}\n                    disabled={saving}\n                />\n                <TextField\n                    value={priority}\n                    onChange={handlePriorityChange}\n                    required\n                    error={priorityError}\n                    helperText={priorityError ? \"请输入一个 0 到 99999 范围内的整数\" : \"数值越大的规则优先级越高\"}\n                    type=\"number\"\n                    label=\"优先级\"\n                    variant=\"outlined\"\n                    margin=\"normal\"\n                    style={{ width: \"25%\", marginLeft: theme.spacing(2) }}\n                    disabled={saving}\n                />\n                <div style={{ flexGrow: 1 }} />\n                <FormControlLabel\n                    control={\n                        <Checkbox\n                            checked={status.indexOf(\"on\") !== -1}\n                            onChange={handleIsEnabledChange}\n                            disabled={saving}\n                        />\n                    }\n                    label=\"启用规则\"\n                />\n            </FormGroup>\n            <TextField\n                value={remark}\n                onChange={handleRemarkChange}\n                multiline\n                fullWidth\n                label=\"规则备注\"\n                helperText=\"可以为空，允许多行\"\n                margin=\"normal\"\n                InputLabelProps={{ shrink: true }}\n                disabled={saving}\n            />\n            <RuleEditor\n                ref={editorRef}\n                defaultEditMode={editMode}\n                defaultRuleData={ruleData}\n                defaultRuleText={ruleText}\n                onChange={handleRuleEditorChange}\n                onNetworkError={handleRuleEditorNetworkError}\n                disabled={saving}\n            />\n            {compileMessage.length > 0 && (\n                <MuiAlert\n                    elevation={0}\n                    variant=\"filled\"\n                    severity=\"error\"\n                    style={{ marginTop: theme.spacing(1) }}\n                ><div dangerouslySetInnerHTML={{ __html: `规则编译失败：${compileMessage}` }} /></MuiAlert>\n            )}\n            <div>\n                <FormControlLabel\n                    control={\n                        <Checkbox\n                            checked={status.indexOf(\"uncompiled\") === -1}\n                            onChange={handleIsCompiledChange}\n                            disabled={saving}\n                        />\n                    }\n                    label=\"编译规则\"\n                />\n            </div>\n            <div className={classes.wrapper}>\n                <Button\n                    variant=\"contained\"\n                    disableElevation\n                    color=\"primary\"\n                    className={isSaved ? classes.buttonSuccess : \"\"}\n                    startIcon={<SaveIcon />}\n                    onClick={handleSaveButtonClick}\n                    disabled={saving}\n                >{isSaved ? \"已保存\" : \"保存\"}</Button>\n                {saving && <CircularProgress size={24} className={classes.buttonProgress} />}\n            </div>\n            <Snackbar open={adjusted} autoHideDuration={6000} onClose={() => setAdjusted(false)}>\n                <MuiAlert elevation={6} variant=\"filled\" onClose={() => setAdjusted(false)} severity=\"warning\">\n                    由于规则编译失败，规则状态已被调整。\n                </MuiAlert>\n            </Snackbar>\n            <Dialog\n                open={dialogOpen}\n                onClose={handleDialogClose}\n            >\n                <DialogTitle>{dialogTitle}</DialogTitle>\n                <DialogContent>\n                    <DialogContentText\n                        dangerouslySetInnerHTML={{\n                            __html: dialogContent\n                        }}\n                    />\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={handleDialogClose} color=\"primary\" autoFocus>\n                        {dialogButton}\n                    </Button>\n                </DialogActions>\n            </Dialog>\n        </Container>\n    ) : (\n        <div className={classes.placeholder}>\n            <Fade in unmountOnExit style={{ transitionDelay: '800ms' }}>\n                <CircularProgress color=\"secondary\" />\n            </Fade>\n        </div>\n    );\n}\n"],"sourceRoot":""}